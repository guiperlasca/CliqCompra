@startuml

actor Convidado
actor Cliente
actor Vendedor
actor Administrador
actor "Usuário Autenticado" as UsuarioAutenticado #LightGray

UsuarioAutenticado <|-- Cliente
UsuarioAutenticado <|-- Vendedor
UsuarioAutenticado <|-- Administrador
' Supondo que Admin também é um usuário autenticado

package "Casos de Uso do Convidado" {
  usecase "Visualizar Produtos" as UC_VisualizarProdutos
  usecase "Registrar Conta" as UC_RegistrarConta
  usecase "Fazer Login" as UC_FazerLogin
}

package "Casos de Uso do Cliente" {
  usecase "Gerenciar Carrinho de Compras" as UC_GerenciarCarrinho
  usecase "Finalizar Compra" as UC_FinalizarCompra
  ' Changed from "Processo de Checkout" for better PT
  usecase "Visualizar Histórico de Pedidos" as UC_VisualizarHistoricoPedidos
  usecase "Gerenciar Endereços" as UC_GerenciarEnderecos
  usecase "Gerenciar Perfil" as UC_GerenciarPerfil_Cliente
}

package "Casos de Uso do Vendedor" {
  usecase "Gerenciar Produtos" as UC_GerenciarProdutos_Vendedor
  note right of UC_GerenciarProdutos_Vendedor : Adicionar, Visualizar Próprios, Excluir
  usecase "Gerenciar Perfil" as UC_GerenciarPerfil_Vendedor
}

package "Casos de Uso do Administrador" {
  usecase "Gerenciar Usuários (CRUD)" as UC_GerenciarUsuarios
  usecase "Gerenciar Todos os Produtos (CRUD)" as UC_GerenciarTodosProdutos
  usecase "Gerenciar Pedidos (CRUD)" as UC_GerenciarPedidos
  usecase "Gerenciar Perfil" as UC_GerenciarPerfil_Admin
}

' Relacionamentos do Convidado
Convidado --> UC_VisualizarProdutos
Convidado --> UC_RegistrarConta
Convidado --> UC_FazerLogin

' Ações comuns do Usuário Autenticado (implícito via herança)
UsuarioAutenticado --> UC_FazerLogin
UsuarioAutenticado --> UC_VisualizarProdutos
' Usuários autenticados também podem visualizar produtos

' Relacionamentos do Cliente
Cliente --> UC_GerenciarCarrinho
Cliente --> UC_FinalizarCompra
Cliente --> UC_VisualizarHistoricoPedidos
Cliente --> UC_GerenciarEnderecos
Cliente --> UC_GerenciarPerfil_Cliente

' Relacionamentos do Vendedor
Vendedor --> UC_GerenciarProdutos_Vendedor
Vendedor --> UC_GerenciarPerfil_Vendedor

' Relacionamentos do Administrador
Administrador --> UC_GerenciarUsuarios
Administrador --> UC_GerenciarTodosProdutos
Administrador --> UC_GerenciarPedidos
Administrador --> UC_GerenciarPerfil_Admin

' Generalização de Gerenciar Perfil se for um caso de uso comum para todos os usuários autenticados
' Se Gerenciar Perfil for distinto para cada um, os separados estão bons.
' Para um "Gerenciar Próprio Perfil" compartilhado que todos os usuários autenticados podem fazer:
' UsuarioAutenticado --> UC_GerenciarProprioPerfil
' UC_GerenciarPerfil_Cliente -|> UC_GerenciarProprioPerfil
' UC_GerenciarPerfil_Vendedor -|> UC_GerenciarProprioPerfil
' UC_GerenciarPerfil_Admin -|> UC_GerenciarProprioPerfil
' Para esta iteração, mantendo-os separados como descrito inicialmente.

@enduml
